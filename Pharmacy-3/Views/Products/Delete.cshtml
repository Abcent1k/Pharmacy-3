@model Pharmacy_3.Models.Products.Product

@{
	ViewBag.Title = "Delete Product";
}

<h2>Delete Product</h2>

<h3>Are you sure you want to delete this?</h3>
<div>
	<h4>@Model.Name</h4>
	<hr />
	<dl class="row">
		<dt class="col-sm-2">Price</dt>
		<dd class="col-sm-10">@Model.Price</dd>
	</dl>

	<button id="deleteBtn" class="btn btn-danger">Delete</button>
	<a asp-action="Index" class="btn btn-secondary">Back to List</a>
</div>

<script>
	document.getElementById("deleteBtn").addEventListener("click", function () {
		const productId = @Model.UPC;

		if (confirm("Are you sure you want to delete this product?")) {
			fetch(`/api/productsapi/${productId}`, {
				method: "DELETE"
			})
				.then(response => {
					if (response.ok) {
						alert("Product deleted successfully.");
						window.location.href = "/Products";
					} else {
						alert("Failed to delete product.");
					}
				})
				.catch(error => {
					console.error("Error deleting product:", error);
					alert("An error occurred while deleting the product.");
				});
		}
	});
</script>
